# 划分数据盘

[TOC]

## 1. 参考

<https://support.huaweicloud.com/qs-ecs/zh-cn_topic_0085634797.html>

## 2. 查看数据盘

```sh
fdisk -l
```

## 3. 分区

```sh
fdisk /dev/sdb
....
```

- n 新建分区
- w 写入(把所有操作都执行完后再写入，如操作有误可以未写入就直接退出)
- q 退出

## 4. 将新建分区文件系统设为系统所需格式

```sh
mkfs -t ext4 /dev/sdb1
....
```

## 5. 挂载

```sh
mount /dev/sdb1 <挂载的路径>
# 查看挂载结果
df -TH
```

## 6. 设置开机自动挂载

- 查询磁盘分区的UUID

不建议直接指定设备名（比如/dev/sdb1），因为云中设备的顺序编码在关闭或者开启云服务器过程中可能发生改变，所以要查出分区的UUID

```sh
blkid
```

- 编辑fstab

```sh
vi /etc/fstab
```

- 添加如下内容

```ini
UUID=a02994bc-b51c-4120-abee-9527c8fc9212 /usr/local ext4 defaults 0 2
```

- 说明
  - 第1列 UUID
  - 第2列 磁盘分区的挂载目录，可以通过 `df -TH` 命令查询
  - 第3列 磁盘分区的文件系统格式，可以通过 `df -TH` 命令查询
  - 第4列 磁盘分区的挂载选项，此处通常设置为defaults即可
  - 第5列 Linux dump备份选项
    - 0 表示不使用Linux dump备份。现在通常不使用dump备份，此处设置为0即可
    - 1 表示使用Linux dump备份
  - 第6列 fsck选项，即开机时是否使用fsck检查磁盘
    - 0 表示不检验
    - 挂载点为（/）根目录的分区，此处必须填写1；根分区设置为1，其他分区只能从2开始，系统会按照数字从小到大依次检查下去

- 检查是否设置成功

```sh
# 卸载已挂载的分区
umount /dev/sdb1
# 将“/etc/fstab”文件所有内容重新加载
mount -a
# 检查
df -TH
```
